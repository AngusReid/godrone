#!/usr/bin/env expect -f
set ip [lindex $argv 0]
set bin [lindex $argv 1]

spawn telnet $ip
expect -re .*#
send "cd /data/video\n"
expect -re .*#
send "killall program.elf\n"
expect -re .*#
send "killall $bin\n"
expect -re .*#
send "rm $bin\n"
expect -re .*#
send "mv $bin.next $bin\n"
expect -re .*#
send "chmod +x $bin\n"
expect -re .*#
send "./$bin\n"
set timeout -1
expect -re .*#
